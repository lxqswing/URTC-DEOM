{"ast":null,"code":"'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.getItemTree = exports.rootPrefix = undefined;\n\nvar _each2 = require('lodash/each');\n\nvar _each3 = _interopRequireDefault(_each2);\n\nvar _findIndex2 = require('lodash/findIndex');\n\nvar _findIndex3 = _interopRequireDefault(_findIndex2);\n\nvar _filter2 = require('lodash/filter');\n\nvar _filter3 = _interopRequireDefault(_filter2);\n\nvar _map2 = require('lodash/map');\n\nvar _map3 = _interopRequireDefault(_map2);\n\nvar _assign2 = require('lodash/assign');\n\nvar _assign3 = _interopRequireDefault(_assign2);\n\nvar _once2 = require('lodash/once');\n\nvar _once3 = _interopRequireDefault(_once2);\n\nvar _extends = Object.assign || function (target) {\n  for (var i = 1; i < arguments.length; i++) {\n    var source = arguments[i];\n\n    for (var key in source) {\n      if (Object.prototype.hasOwnProperty.call(source, key)) {\n        target[key] = source[key];\n      }\n    }\n  }\n\n  return target;\n};\n\nvar _createClass = function () {\n  function defineProperties(target, props) {\n    for (var i = 0; i < props.length; i++) {\n      var descriptor = props[i];\n      descriptor.enumerable = descriptor.enumerable || false;\n      descriptor.configurable = true;\n      if (\"value\" in descriptor) descriptor.writable = true;\n      Object.defineProperty(target, descriptor.key, descriptor);\n    }\n  }\n\n  return function (Constructor, protoProps, staticProps) {\n    if (protoProps) defineProperties(Constructor.prototype, protoProps);\n    if (staticProps) defineProperties(Constructor, staticProps);\n    return Constructor;\n  };\n}();\n\nvar _dec, _dec2, _class, _class2, _temp, _initialiseProps;\n\nvar _react = require('react');\n\nvar _react2 = _interopRequireDefault(_react);\n\nvar _propTypes = require('prop-types');\n\nvar _propTypes2 = _interopRequireDefault(_propTypes);\n\nvar _classnames = require('classnames');\n\nvar _classnames2 = _interopRequireDefault(_classnames);\n\nvar _uncontrolled = require('../../decorators/uncontrolled');\n\nvar _uncontrolled2 = _interopRequireDefault(_uncontrolled);\n\nvar _localeConsumerDecorator = require('../../components/LocaleProvider/localeConsumerDecorator');\n\nvar _localeConsumerDecorator2 = _interopRequireDefault(_localeConsumerDecorator);\n\nvar _deprecatedLog = require('../../utils/deprecatedLog');\n\nvar _deprecatedLog2 = _interopRequireDefault(_deprecatedLog);\n\nvar _Checkbox = require('../../components/Checkbox');\n\nvar _Checkbox2 = _interopRequireDefault(_Checkbox);\n\nvar _style = require('./style');\n\nvar _zh_CN = require('./locale/zh_CN');\n\nvar _zh_CN2 = _interopRequireDefault(_zh_CN);\n\nfunction _interopRequireDefault(obj) {\n  return obj && obj.__esModule ? obj : {\n    default: obj\n  };\n}\n\nfunction _objectWithoutProperties(obj, keys) {\n  var target = {};\n\n  for (var i in obj) {\n    if (keys.indexOf(i) >= 0) continue;\n    if (!Object.prototype.hasOwnProperty.call(obj, i)) continue;\n    target[i] = obj[i];\n  }\n\n  return target;\n}\n\nfunction _classCallCheck(instance, Constructor) {\n  if (!(instance instanceof Constructor)) {\n    throw new TypeError(\"Cannot call a class as a function\");\n  }\n}\n\nfunction _possibleConstructorReturn(self, call) {\n  if (!self) {\n    throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");\n  }\n\n  return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self;\n}\n\nfunction _inherits(subClass, superClass) {\n  if (typeof superClass !== \"function\" && superClass !== null) {\n    throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass);\n  }\n\n  subClass.prototype = Object.create(superClass && superClass.prototype, {\n    constructor: {\n      value: subClass,\n      enumerable: false,\n      writable: true,\n      configurable: true\n    }\n  });\n  if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass;\n}\n\nvar deprecatedLogForTheme = (0, _once3.default)(function () {\n  return (0, _deprecatedLog2.default)('Menu theme', 'ThemeProvider');\n});\nvar deprecatedLogForThemeType = (0, _once3.default)(function () {\n  return (0, _deprecatedLog2.default)('Menu themeType', 'ThemeProvider');\n});\nvar rootPrefix = exports.rootPrefix = 'root';\n\nvar getItemTree = exports.getItemTree = function getItemTree(children) {\n  var getTree = function getTree(children, prefix) {\n    var items = {};\n    var groupTree = {};\n\n    _react2.default.Children.forEach(children, function (child, i) {\n      if (!_react2.default.isValidElement(child)) {\n        return;\n      }\n\n      var childType = child.type;\n      var isMenuItem = childType.isMenuItem;\n      var isOtherMenuComponent = childType.isMenuSubMenu || childType.isMenuGroup;\n\n      if (isMenuItem) {\n        var uid = prefix + '-' + i + '-item';\n        items[uid] = child;\n      } else if (isOtherMenuComponent) {\n        var _uid = prefix + '-' + i + '-group';\n\n        var childGroupTree = getTree(child.props.children, _uid);\n        (0, _assign3.default)(groupTree, childGroupTree);\n        (0, _assign3.default)(items, childGroupTree[_uid]);\n      }\n    });\n\n    groupTree[prefix] = items;\n    return groupTree;\n  };\n\n  return getTree(children, rootPrefix);\n};\n\nvar Menu = (_dec = (0, _localeConsumerDecorator2.default)({\n  defaultLocale: _zh_CN2.default,\n  localeName: 'Menu'\n}), _dec2 = (0, _uncontrolled2.default)({\n  valueName: 'selectedKeys'\n}), _dec(_class = _dec2(_class = (_temp = _class2 = function (_Component) {\n  _inherits(Menu, _Component);\n\n  function Menu(props) {\n    _classCallCheck(this, Menu);\n\n    var _this = _possibleConstructorReturn(this, (Menu.__proto__ || Object.getPrototypeOf(Menu)).call(this, props));\n\n    _initialiseProps.call(_this);\n\n    var children = props.children;\n\n    if ('itemTree' in props) {\n      _this.itemTree = props.itemTree;\n    } else {\n      _this.itemTree = getItemTree(children);\n    }\n\n    if ('theme' in props) {\n      deprecatedLogForTheme();\n    }\n\n    if ('themeType' in props) {\n      deprecatedLogForThemeType();\n    }\n\n    return _this;\n  }\n\n  _createClass(Menu, [{\n    key: 'componentWillReceiveProps',\n    value: function componentWillReceiveProps(nextProps) {\n      var children = nextProps.children;\n\n      if ('itemTree' in nextProps) {\n        return this.itemTree = nextProps.itemTree;\n      }\n\n      if (children === this.props.children) return;\n      this.itemTree = getItemTree(children);\n    }\n  }, {\n    key: 'render',\n    value: function render() {\n      var _this2 = this;\n      /* eslint-disable no-unused-vars */\n\n\n      var _props = this.props,\n          selectedKeys = _props.selectedKeys,\n          defaultSelectedKeys = _props.defaultSelectedKeys,\n          onChange = _props.onChange,\n          multiple = _props.multiple,\n          selectable = _props.selectable,\n          showSelectAll = _props.showSelectAll,\n          collapse = _props.collapse,\n          children = _props.children,\n          theme = _props.theme,\n          themeType = _props.themeType,\n          itemTree = _props.itemTree,\n          locale = _props.locale,\n          className = _props.className,\n          block = _props.block,\n          disabled = _props.disabled,\n          rest = _objectWithoutProperties(_props, ['selectedKeys', 'defaultSelectedKeys', 'onChange', 'multiple', 'selectable', 'showSelectAll', 'collapse', 'children', 'theme', 'themeType', 'itemTree', 'locale', 'className', 'block', 'disabled']);\n      /* eslint-enable no-unused-vars */\n\n\n      var allSelectedStatus = this.getAllSelectedStatus(rootPrefix);\n\n      var selectAllCheckbox = multiple && showSelectAll && _react2.default.createElement('div', {\n        className: (0, _classnames2.default)(_style.selectallWrapCls, disabled && _style.disabledCls)\n      }, _react2.default.createElement(_Checkbox2.default, {\n        className: _style.checkboxCls,\n        checked: allSelectedStatus === 'ALL',\n        indeterminate: allSelectedStatus === 'PART',\n        onChange: function onChange(checked) {\n          return _this2.onMultipleSelect(checked, rootPrefix);\n        },\n        size: 'lg',\n        disabled: disabled\n      }, locale.selectAll));\n\n      return _react2.default.createElement(_style.MenuWrap, _extends({\n        className: (0, _classnames2.default)(className, _style.prefixCls, multiple ? _style.multipleCls : _style.singleCls, block && _style.blockCls)\n      }, rest, collapse), _react2.default.createElement('div', null, selectAllCheckbox, this.renderChildren(children, rootPrefix)));\n    }\n  }]);\n\n  return Menu;\n}(_react.Component), _class2.propTypes = {\n  /** 选中的菜单项的key，controlled */\n  selectedKeys: _propTypes2.default.array,\n\n  /** 默认选中的菜单项的key，uncontrolled */\n  defaultSelectedKeys: _propTypes2.default.array,\n\n  /** 选中变化时的回调 */\n  onChange: _propTypes2.default.func,\n\n  /** 是否支持多选 */\n  multiple: _propTypes2.default.bool,\n\n  /** 是否可选 */\n  selectable: _propTypes2.default.bool,\n\n  /** collapse的配置，参考collpase组件 */\n  collapse: _propTypes2.default.object,\n\n  /** 是否显示全选，多选时有效 */\n  showSelectAll: _propTypes2.default.bool,\n\n  /** 是否使用块元素显示模式，去除宽高限制，撑满容器，去除外阴影、border，方便放置在自定义容器中 */\n  block: _propTypes2.default.bool,\n\n  /** 是否禁用 */\n  disabled: _propTypes2.default.bool,\n\n  /** 自定义样式 */\n  customStyle: _propTypes2.default.shape({\n    /** 菜单的最大高度 */\n    maxHeight: _propTypes2.default.string\n  }),\n\n  /** @ignore */\n  theme: _propTypes2.default.any,\n\n  /** @ignore */\n  themeType: _propTypes2.default.any,\n\n  /** @ignore */\n  children: _propTypes2.default.node,\n\n  /** @ignore */\n  itemTree: _propTypes2.default.any,\n\n  /** @ignore */\n  locale: _propTypes2.default.object,\n\n  /** @ignore */\n  className: _propTypes2.default.string\n}, _class2.defaultProps = {\n  defaultSelectedKeys: [],\n  onChange: function onChange() {},\n  selectable: true\n}, _initialiseProps = function _initialiseProps() {\n  var _this3 = this;\n\n  this.getAllSelectedStatus = function (groupUid) {\n    var selectedKeys = _this3.props.selectedKeys;\n\n    if (!selectedKeys || !selectedKeys.length) {\n      return 'NONE';\n    }\n\n    var items = _this3.itemTree[groupUid];\n    var itemKeys = (0, _map3.default)((0, _filter3.default)(items, function (item) {\n      return !item.props.disabled;\n    }), function (item) {\n      return item.type.getItemKey(item);\n    });\n    var selectedItemKeys = (0, _filter3.default)(itemKeys, function (key) {\n      return (0, _findIndex3.default)(selectedKeys, function (selectedKey) {\n        return selectedKey === key;\n      }) >= 0;\n    });\n\n    if (!selectedItemKeys.length) {\n      return 'NONE';\n    } else if (selectedItemKeys.length < itemKeys.length) {\n      return 'PART';\n    } else {\n      return 'ALL';\n    }\n  };\n\n  this.getItemSelected = function (itemUid) {\n    var selectedKeys = _this3.props.selectedKeys;\n\n    var itemKey = _this3.getItemKey(itemUid);\n\n    return (0, _findIndex3.default)(selectedKeys, function (key) {\n      return key === itemKey;\n    }) >= 0;\n  };\n\n  this.getItemKey = function (itemUid) {\n    var item = _this3.itemTree[rootPrefix][itemUid];\n    return item.type.getItemKey(item);\n  };\n\n  this._selectItem = function () {\n    var selectedKeys = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : [];\n    var selected = arguments[1];\n    var uid = arguments[2];\n    var multiple = _this3.props.multiple;\n\n    var itemKey = _this3.getItemKey(uid);\n\n    var isSelected = _this3.getItemSelected(uid);\n\n    if (multiple) {\n      if (isSelected && !selected) {\n        return selectedKeys.filter(function (key) {\n          return key !== itemKey;\n        });\n      } else if (!isSelected && selected) {\n        return selectedKeys.concat(itemKey);\n      } else {\n        return selectedKeys;\n      }\n    } else {\n      return [itemKey];\n    }\n  };\n\n  this.onSelect = function (selected, uid) {\n    var _props2 = _this3.props,\n        onChange = _props2.onChange,\n        selectedKeys = _props2.selectedKeys,\n        selectable = _props2.selectable;\n\n    if (!selectable) {\n      return;\n    }\n\n    onChange(_this3._selectItem(selectedKeys, selected, uid));\n  };\n\n  this.onMultipleSelect = function (selected, groupUid) {\n    var _props3 = _this3.props,\n        onChange = _props3.onChange,\n        _selectedKeys = _props3.selectedKeys,\n        selectable = _props3.selectable;\n\n    if (!selectable) {\n      return;\n    }\n\n    var items = _this3.itemTree[groupUid];\n    var selectedKeys = _selectedKeys;\n    (0, _each3.default)(items, function (item, uid) {\n      if (!item.props.disabled) {\n        selectedKeys = _this3._selectItem(selectedKeys, selected, uid);\n      }\n    });\n    onChange(selectedKeys);\n  };\n\n  this.renderChildren = function (children, prefix) {\n    var _props4 = _this3.props,\n        multiple = _props4.multiple,\n        globalDisabled = _props4.disabled;\n\n    var renderChildren = function renderChildren(children) {\n      var l = _react2.default.Children.count(children) - 1;\n      return _react2.default.Children.map(children, function (child, i) {\n        if (!_react2.default.isValidElement(child)) {\n          return child;\n        }\n\n        var childType = child.type;\n        var isMenuItem = childType.isMenuItem;\n        var isOtherMenuComponent = childType.isMenuSubMenu || childType.isMenuGroup;\n        var isFirst = i === 0;\n        var isLast = i === l;\n        var className = (0, _classnames2.default)(child.props.className, isFirst && _style.firstCls, isLast && _style.lastCls);\n        var disabled = globalDisabled || child.props.disabled;\n\n        if (isMenuItem) {\n          var uid = prefix + '-' + i + '-item';\n          return _react2.default.cloneElement(child, {\n            uid: uid,\n            multiple: multiple,\n            disabled: disabled,\n            selected: _this3.getItemSelected(uid),\n            onSelect: _this3.onSelect,\n            className: className\n          });\n        } else if (isOtherMenuComponent) {\n          var _uid2 = prefix + '-' + i + '-group';\n\n          return _react2.default.cloneElement(child, {\n            uid: _uid2,\n            multiple: multiple,\n            disabled: disabled,\n            allSelectedStatus: _this3.getAllSelectedStatus(_uid2),\n            onMultipleSelect: _this3.onMultipleSelect,\n            renderChildren: function renderChildren(children) {\n              return _this3.renderChildren(children, _uid2);\n            },\n            className: className\n          });\n        }\n\n        return child;\n      });\n    };\n\n    return renderChildren(children);\n  };\n}, _temp)) || _class) || _class);\nexports.default = Menu;","map":{"version":3,"sources":["/Users/lixiqing/work/URTC-DEOM/node_modules/@ucloud-fe/react-components/lib/components/Menu/Menu.js"],"names":["Object","defineProperty","exports","value","getItemTree","rootPrefix","undefined","_each2","require","_each3","_interopRequireDefault","_findIndex2","_findIndex3","_filter2","_filter3","_map2","_map3","_assign2","_assign3","_once2","_once3","_extends","assign","target","i","arguments","length","source","key","prototype","hasOwnProperty","call","_createClass","defineProperties","props","descriptor","enumerable","configurable","writable","Constructor","protoProps","staticProps","_dec","_dec2","_class","_class2","_temp","_initialiseProps","_react","_react2","_propTypes","_propTypes2","_classnames","_classnames2","_uncontrolled","_uncontrolled2","_localeConsumerDecorator","_localeConsumerDecorator2","_deprecatedLog","_deprecatedLog2","_Checkbox","_Checkbox2","_style","_zh_CN","_zh_CN2","obj","__esModule","default","_objectWithoutProperties","keys","indexOf","_classCallCheck","instance","TypeError","_possibleConstructorReturn","self","ReferenceError","_inherits","subClass","superClass","create","constructor","setPrototypeOf","__proto__","deprecatedLogForTheme","deprecatedLogForThemeType","children","getTree","prefix","items","groupTree","Children","forEach","child","isValidElement","childType","type","isMenuItem","isOtherMenuComponent","isMenuSubMenu","isMenuGroup","uid","_uid","childGroupTree","Menu","defaultLocale","localeName","valueName","_Component","_this","getPrototypeOf","itemTree","componentWillReceiveProps","nextProps","render","_this2","_props","selectedKeys","defaultSelectedKeys","onChange","multiple","selectable","showSelectAll","collapse","theme","themeType","locale","className","block","disabled","rest","allSelectedStatus","getAllSelectedStatus","selectAllCheckbox","createElement","selectallWrapCls","disabledCls","checkboxCls","checked","indeterminate","onMultipleSelect","size","selectAll","MenuWrap","prefixCls","multipleCls","singleCls","blockCls","renderChildren","Component","propTypes","array","func","bool","object","customStyle","shape","maxHeight","string","any","node","defaultProps","_this3","groupUid","itemKeys","item","getItemKey","selectedItemKeys","selectedKey","getItemSelected","itemUid","itemKey","_selectItem","selected","isSelected","filter","concat","onSelect","_props2","_props3","_selectedKeys","_props4","globalDisabled","l","count","map","isFirst","isLast","firstCls","lastCls","cloneElement","_uid2"],"mappings":"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","sourcesContent":["'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\nexports.getItemTree = exports.rootPrefix = undefined;\n\nvar _each2 = require('lodash/each');\n\nvar _each3 = _interopRequireDefault(_each2);\n\nvar _findIndex2 = require('lodash/findIndex');\n\nvar _findIndex3 = _interopRequireDefault(_findIndex2);\n\nvar _filter2 = require('lodash/filter');\n\nvar _filter3 = _interopRequireDefault(_filter2);\n\nvar _map2 = require('lodash/map');\n\nvar _map3 = _interopRequireDefault(_map2);\n\nvar _assign2 = require('lodash/assign');\n\nvar _assign3 = _interopRequireDefault(_assign2);\n\nvar _once2 = require('lodash/once');\n\nvar _once3 = _interopRequireDefault(_once2);\n\nvar _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; };\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nvar _dec, _dec2, _class, _class2, _temp, _initialiseProps;\n\nvar _react = require('react');\n\nvar _react2 = _interopRequireDefault(_react);\n\nvar _propTypes = require('prop-types');\n\nvar _propTypes2 = _interopRequireDefault(_propTypes);\n\nvar _classnames = require('classnames');\n\nvar _classnames2 = _interopRequireDefault(_classnames);\n\nvar _uncontrolled = require('../../decorators/uncontrolled');\n\nvar _uncontrolled2 = _interopRequireDefault(_uncontrolled);\n\nvar _localeConsumerDecorator = require('../../components/LocaleProvider/localeConsumerDecorator');\n\nvar _localeConsumerDecorator2 = _interopRequireDefault(_localeConsumerDecorator);\n\nvar _deprecatedLog = require('../../utils/deprecatedLog');\n\nvar _deprecatedLog2 = _interopRequireDefault(_deprecatedLog);\n\nvar _Checkbox = require('../../components/Checkbox');\n\nvar _Checkbox2 = _interopRequireDefault(_Checkbox);\n\nvar _style = require('./style');\n\nvar _zh_CN = require('./locale/zh_CN');\n\nvar _zh_CN2 = _interopRequireDefault(_zh_CN);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _objectWithoutProperties(obj, keys) { var target = {}; for (var i in obj) { if (keys.indexOf(i) >= 0) continue; if (!Object.prototype.hasOwnProperty.call(obj, i)) continue; target[i] = obj[i]; } return target; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }\n\nvar deprecatedLogForTheme = (0, _once3.default)(function () {\n    return (0, _deprecatedLog2.default)('Menu theme', 'ThemeProvider');\n});\nvar deprecatedLogForThemeType = (0, _once3.default)(function () {\n    return (0, _deprecatedLog2.default)('Menu themeType', 'ThemeProvider');\n});\n\nvar rootPrefix = exports.rootPrefix = 'root';\n\nvar getItemTree = exports.getItemTree = function getItemTree(children) {\n    var getTree = function getTree(children, prefix) {\n        var items = {};\n        var groupTree = {};\n        _react2.default.Children.forEach(children, function (child, i) {\n            if (!_react2.default.isValidElement(child)) {\n                return;\n            }\n            var childType = child.type;\n            var isMenuItem = childType.isMenuItem;\n            var isOtherMenuComponent = childType.isMenuSubMenu || childType.isMenuGroup;\n\n            if (isMenuItem) {\n                var uid = prefix + '-' + i + '-item';\n                items[uid] = child;\n            } else if (isOtherMenuComponent) {\n                var _uid = prefix + '-' + i + '-group';\n                var childGroupTree = getTree(child.props.children, _uid);\n\n                (0, _assign3.default)(groupTree, childGroupTree);\n                (0, _assign3.default)(items, childGroupTree[_uid]);\n            }\n        });\n        groupTree[prefix] = items;\n        return groupTree;\n    };\n\n    return getTree(children, rootPrefix);\n};\n\nvar Menu = (_dec = (0, _localeConsumerDecorator2.default)({ defaultLocale: _zh_CN2.default, localeName: 'Menu' }), _dec2 = (0, _uncontrolled2.default)({\n    valueName: 'selectedKeys'\n}), _dec(_class = _dec2(_class = (_temp = _class2 = function (_Component) {\n    _inherits(Menu, _Component);\n\n    function Menu(props) {\n        _classCallCheck(this, Menu);\n\n        var _this = _possibleConstructorReturn(this, (Menu.__proto__ || Object.getPrototypeOf(Menu)).call(this, props));\n\n        _initialiseProps.call(_this);\n\n        var children = props.children;\n\n        if ('itemTree' in props) {\n            _this.itemTree = props.itemTree;\n        } else {\n            _this.itemTree = getItemTree(children);\n        }\n        if ('theme' in props) {\n            deprecatedLogForTheme();\n        }\n        if ('themeType' in props) {\n            deprecatedLogForThemeType();\n        }\n        return _this;\n    }\n\n    _createClass(Menu, [{\n        key: 'componentWillReceiveProps',\n        value: function componentWillReceiveProps(nextProps) {\n            var children = nextProps.children;\n\n            if ('itemTree' in nextProps) {\n                return this.itemTree = nextProps.itemTree;\n            }\n            if (children === this.props.children) return;\n            this.itemTree = getItemTree(children);\n        }\n    }, {\n        key: 'render',\n        value: function render() {\n            var _this2 = this;\n\n            /* eslint-disable no-unused-vars */\n            var _props = this.props,\n                selectedKeys = _props.selectedKeys,\n                defaultSelectedKeys = _props.defaultSelectedKeys,\n                onChange = _props.onChange,\n                multiple = _props.multiple,\n                selectable = _props.selectable,\n                showSelectAll = _props.showSelectAll,\n                collapse = _props.collapse,\n                children = _props.children,\n                theme = _props.theme,\n                themeType = _props.themeType,\n                itemTree = _props.itemTree,\n                locale = _props.locale,\n                className = _props.className,\n                block = _props.block,\n                disabled = _props.disabled,\n                rest = _objectWithoutProperties(_props, ['selectedKeys', 'defaultSelectedKeys', 'onChange', 'multiple', 'selectable', 'showSelectAll', 'collapse', 'children', 'theme', 'themeType', 'itemTree', 'locale', 'className', 'block', 'disabled']);\n            /* eslint-enable no-unused-vars */\n\n\n            var allSelectedStatus = this.getAllSelectedStatus(rootPrefix);\n            var selectAllCheckbox = multiple && showSelectAll && _react2.default.createElement(\n                'div',\n                { className: (0, _classnames2.default)(_style.selectallWrapCls, disabled && _style.disabledCls) },\n                _react2.default.createElement(\n                    _Checkbox2.default,\n                    {\n                        className: _style.checkboxCls,\n                        checked: allSelectedStatus === 'ALL',\n                        indeterminate: allSelectedStatus === 'PART',\n                        onChange: function onChange(checked) {\n                            return _this2.onMultipleSelect(checked, rootPrefix);\n                        },\n                        size: 'lg',\n                        disabled: disabled\n                    },\n                    locale.selectAll\n                )\n            );\n            return _react2.default.createElement(\n                _style.MenuWrap,\n                _extends({\n                    className: (0, _classnames2.default)(className, _style.prefixCls, multiple ? _style.multipleCls : _style.singleCls, block && _style.blockCls)\n                }, rest, collapse),\n                _react2.default.createElement(\n                    'div',\n                    null,\n                    selectAllCheckbox,\n                    this.renderChildren(children, rootPrefix)\n                )\n            );\n        }\n    }]);\n\n    return Menu;\n}(_react.Component), _class2.propTypes = {\n    /** 选中的菜单项的key，controlled */\n    selectedKeys: _propTypes2.default.array,\n    /** 默认选中的菜单项的key，uncontrolled */\n    defaultSelectedKeys: _propTypes2.default.array,\n    /** 选中变化时的回调 */\n    onChange: _propTypes2.default.func,\n    /** 是否支持多选 */\n    multiple: _propTypes2.default.bool,\n    /** 是否可选 */\n    selectable: _propTypes2.default.bool,\n    /** collapse的配置，参考collpase组件 */\n    collapse: _propTypes2.default.object,\n    /** 是否显示全选，多选时有效 */\n    showSelectAll: _propTypes2.default.bool,\n    /** 是否使用块元素显示模式，去除宽高限制，撑满容器，去除外阴影、border，方便放置在自定义容器中 */\n    block: _propTypes2.default.bool,\n    /** 是否禁用 */\n    disabled: _propTypes2.default.bool,\n    /** 自定义样式 */\n    customStyle: _propTypes2.default.shape({\n        /** 菜单的最大高度 */\n        maxHeight: _propTypes2.default.string\n    }),\n    /** @ignore */\n    theme: _propTypes2.default.any,\n    /** @ignore */\n    themeType: _propTypes2.default.any,\n    /** @ignore */\n    children: _propTypes2.default.node,\n    /** @ignore */\n    itemTree: _propTypes2.default.any,\n    /** @ignore */\n    locale: _propTypes2.default.object,\n    /** @ignore */\n    className: _propTypes2.default.string\n}, _class2.defaultProps = {\n    defaultSelectedKeys: [],\n    onChange: function onChange() {},\n    selectable: true\n}, _initialiseProps = function _initialiseProps() {\n    var _this3 = this;\n\n    this.getAllSelectedStatus = function (groupUid) {\n        var selectedKeys = _this3.props.selectedKeys;\n\n        if (!selectedKeys || !selectedKeys.length) {\n            return 'NONE';\n        }\n\n        var items = _this3.itemTree[groupUid];\n        var itemKeys = (0, _map3.default)((0, _filter3.default)(items, function (item) {\n            return !item.props.disabled;\n        }), function (item) {\n            return item.type.getItemKey(item);\n        });\n        var selectedItemKeys = (0, _filter3.default)(itemKeys, function (key) {\n            return (0, _findIndex3.default)(selectedKeys, function (selectedKey) {\n                return selectedKey === key;\n            }) >= 0;\n        });\n\n        if (!selectedItemKeys.length) {\n            return 'NONE';\n        } else if (selectedItemKeys.length < itemKeys.length) {\n            return 'PART';\n        } else {\n            return 'ALL';\n        }\n    };\n\n    this.getItemSelected = function (itemUid) {\n        var selectedKeys = _this3.props.selectedKeys;\n\n        var itemKey = _this3.getItemKey(itemUid);\n        return (0, _findIndex3.default)(selectedKeys, function (key) {\n            return key === itemKey;\n        }) >= 0;\n    };\n\n    this.getItemKey = function (itemUid) {\n        var item = _this3.itemTree[rootPrefix][itemUid];\n        return item.type.getItemKey(item);\n    };\n\n    this._selectItem = function () {\n        var selectedKeys = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : [];\n        var selected = arguments[1];\n        var uid = arguments[2];\n        var multiple = _this3.props.multiple;\n\n        var itemKey = _this3.getItemKey(uid);\n        var isSelected = _this3.getItemSelected(uid);\n        if (multiple) {\n            if (isSelected && !selected) {\n                return selectedKeys.filter(function (key) {\n                    return key !== itemKey;\n                });\n            } else if (!isSelected && selected) {\n                return selectedKeys.concat(itemKey);\n            } else {\n                return selectedKeys;\n            }\n        } else {\n            return [itemKey];\n        }\n    };\n\n    this.onSelect = function (selected, uid) {\n        var _props2 = _this3.props,\n            onChange = _props2.onChange,\n            selectedKeys = _props2.selectedKeys,\n            selectable = _props2.selectable;\n\n        if (!selectable) {\n            return;\n        }\n\n        onChange(_this3._selectItem(selectedKeys, selected, uid));\n    };\n\n    this.onMultipleSelect = function (selected, groupUid) {\n        var _props3 = _this3.props,\n            onChange = _props3.onChange,\n            _selectedKeys = _props3.selectedKeys,\n            selectable = _props3.selectable;\n\n        if (!selectable) {\n            return;\n        }\n\n        var items = _this3.itemTree[groupUid];\n\n        var selectedKeys = _selectedKeys;\n        (0, _each3.default)(items, function (item, uid) {\n            if (!item.props.disabled) {\n                selectedKeys = _this3._selectItem(selectedKeys, selected, uid);\n            }\n        });\n\n        onChange(selectedKeys);\n    };\n\n    this.renderChildren = function (children, prefix) {\n        var _props4 = _this3.props,\n            multiple = _props4.multiple,\n            globalDisabled = _props4.disabled;\n\n        var renderChildren = function renderChildren(children) {\n            var l = _react2.default.Children.count(children) - 1;\n            return _react2.default.Children.map(children, function (child, i) {\n                if (!_react2.default.isValidElement(child)) {\n                    return child;\n                }\n\n                var childType = child.type;\n                var isMenuItem = childType.isMenuItem;\n                var isOtherMenuComponent = childType.isMenuSubMenu || childType.isMenuGroup;\n                var isFirst = i === 0;\n                var isLast = i === l;\n                var className = (0, _classnames2.default)(child.props.className, isFirst && _style.firstCls, isLast && _style.lastCls);\n                var disabled = globalDisabled || child.props.disabled;\n                if (isMenuItem) {\n                    var uid = prefix + '-' + i + '-item';\n                    return _react2.default.cloneElement(child, {\n                        uid: uid,\n                        multiple: multiple,\n                        disabled: disabled,\n                        selected: _this3.getItemSelected(uid),\n                        onSelect: _this3.onSelect,\n                        className: className\n                    });\n                } else if (isOtherMenuComponent) {\n                    var _uid2 = prefix + '-' + i + '-group';\n                    return _react2.default.cloneElement(child, {\n                        uid: _uid2,\n                        multiple: multiple,\n                        disabled: disabled,\n                        allSelectedStatus: _this3.getAllSelectedStatus(_uid2),\n                        onMultipleSelect: _this3.onMultipleSelect,\n                        renderChildren: function renderChildren(children) {\n                            return _this3.renderChildren(children, _uid2);\n                        },\n                        className: className\n                    });\n                }\n\n                return child;\n            });\n        };\n\n        return renderChildren(children);\n    };\n}, _temp)) || _class) || _class);\nexports.default = Menu;"]},"metadata":{},"sourceType":"script"}